---
// Event Details Section - Informasi Acara
import EventMap, { type MarkerData } from "@/components/EventMap";
import { CheersIcon, HandshakeIcon, CalendarHeartIcon, BuildingIcon, ChurchIcon, MapPinLineIcon, CalendarPlusIcon } from "@phosphor-icons/react";

const akadMapUrl = "https://maps.app.goo.gl/cfFZBmonoSyPjxba9";
const resepsiMapUrl = "https://maps.app.goo.gl/GV4GL1Mxdfr8JK1f7";

const locations: MarkerData[] = [
  {
    position: [-2.964851786654645, 104.7458745138724],
    title: "Akad Nikah",
    subTitle: "GMI Wesley Palembang",
    autoOpen: true,
    iconName: "ring",
    image: "/images/locations/gmi-wesley.png",
  },
  {
    position: [-2.9734227431754547, 104.71194729999999],
    title: "Resepsi",
    subTitle: "Gedung De' Premium Convention Center",
    autoOpen: true,
    iconName: "confetti",
    image: "/images/locations/gedung-de-premium.jpg",
  },
];

// Google Calendar prefilled event (main wedding schedule)
const eventTitle = "Pernikahan Bagas & Firda ðŸ‘¨ðŸ»â€â¤ï¸â€ðŸ’‹â€ðŸ‘©ðŸ»";
const eventDetails = [
  "Akad: GMI Wesley Palembang (09.00 WIB)",
  `Maps: ${akadMapUrl}\n`,
  "Resepsi: Gedung De' Premium Convention Center (11.00 WIB)",
  `Maps: ${resepsiMapUrl}\n`,
].join("\n");
const eventLocation = "GMI Wesley Palembang, Palembang";
const ctz = "Asia/Jakarta";
// 13 Dec 2025 09:00-11:00 WIB -> UTC 02:00-04:00Z
const startUTC = "20251213T020000Z";
const endUTC = "20251213T040000Z";
const googleCalendarUrl = `https://calendar.google.com/calendar/render?action=TEMPLATE&text=${encodeURIComponent(eventTitle)}&details=${encodeURIComponent(eventDetails)}&location=${encodeURIComponent(eventLocation)}&dates=${startUTC}%2F${endUTC}&ctz=${encodeURIComponent(ctz)}`;
---

<section id="event" class="py-20 px-4 bg-cream">
  <div class="max-w-6xl mx-auto">
    <!-- Section Title -->
    <div class="text-center mb-16 fade-in">
      <h2 class="font-heading text-4xl md:text-5xl font-bold text-primary mb-4">
        Waktu & Tempat
      </h2>
      <div class="w-24 h-1 bg-gold mx-auto mb-6"></div>
      <p class="text-gray-600 text-lg">
        Kami mengundang kamu untuk berbagi kebahagiaan bersama
      </p>
    </div>

    <!-- Countdown Timer -->
    <div class="mb-16 fade-in">
      <div class="bg-gradient-to-r from-primary to-primary/80 text-white rounded-2xl shadow-2xl p-4 md:p-8 max-w-4xl mx-auto">
        <p class="text-center text-xl mb-6">Menghitung Hari Menuju Hari Bahagia</p>
        <div class="grid grid-cols-4 gap-4 text-center">
          <div class="bg-white/10 backdrop-blur-sm rounded-lg p-4">
            <div id="event-days" class="text-2xl md:text-4xl font-bold mb-2">00</div>
            <div class="text-sm uppercase tracking-wider">Hari</div>
          </div>
          <div class="bg-white/10 backdrop-blur-sm rounded-lg p-4">
            <div id="event-hours" class="text-2xl md:text-4xl font-bold mb-2">00</div>
            <div class="text-sm uppercase tracking-wider">Jam</div>
          </div>
          <div class="bg-white/10 backdrop-blur-sm rounded-lg p-4">
            <div id="event-minutes" class="text-2xl md:text-4xl font-bold mb-2">00</div>
            <div class="text-sm uppercase tracking-wider">Menit</div>
          </div>
          <div class="bg-white/10 backdrop-blur-sm rounded-lg p-4">
            <div id="event-seconds" class="text-2xl md:text-4xl font-bold mb-2">00</div>
            <div class="text-sm uppercase tracking-wider">Detik</div>
          </div>
        </div>
      </div>
    </div>

    <!-- Event Cards -->
    <div class="grid md:grid-cols-2 gap-8 mb-16">
      <!-- Akad Nikah -->
      <div class="fade-in">
        <div class="bg-white rounded-2xl shadow-xl p-8 hover:shadow-2xl transition-smooth hover:-translate-y-2">
          <div class="w-20 h-20 bg-gold rounded-full flex items-center justify-center mb-6 mx-auto">
            <HandshakeIcon size={40} weight="fill" className="text-dark" />
          </div>
          <h3 class="text-2xl font-semibold text-primary mb-4 text-center">Akad Nikah</h3>
          <div class="space-y-3 text-gray-700">
            <div class="flex items-start gap-3">
              <CalendarHeartIcon size={24} weight="fill" className="text-gold flex-shrink-0 mt-1" />
              <div>
                <p class="font-semibold">Sabtu, 13 Desember 2025</p>
                <p class="text-sm text-gray-500">Pukul 09.00 - 10.00 WIB</p>
              </div>
            </div>
            <div class="flex items-start gap-3">
              <ChurchIcon size={24} weight="fill" className="text-gold flex-shrink-0 mt-1" />
              <div>
                <p class="font-semibold">Gereja Methodist Indonesia Wesley Palembang</p>
                <p class="text-sm text-gray-500">Jl. Jend. Sudirman KM 3,5 Palembang</p>
              </div>
            </div>
          </div>
          <a
            href={akadMapUrl}
            target="_blank"
            rel="noopener noreferrer"
            aria-label="Buka Google Maps - Lokasi Akad Nikah"
            class="mt-6 w-full bg-primary text-white py-3 rounded-lg font-semibold hover:bg-primary/90 transition-smooth flex items-center justify-center gap-2"
          >
            <MapPinLineIcon size={20} weight="fill" />
            Lihat Lokasi
          </a>
        </div>
      </div>

      <!-- Resepsi -->
      <div class="fade-in">
        <div class="bg-white rounded-2xl shadow-xl p-8 hover:shadow-2xl transition-smooth hover:-translate-y-2">
          <div class="w-20 h-20 bg-gold rounded-full flex items-center justify-center mb-6 mx-auto">
            <CheersIcon size={40} weight="fill" className="text-dark" />   
          </div>
          <h3 class="text-2xl font-semibold text-primary mb-4 text-center">Resepsi Pernikahan</h3>
          <div class="space-y-3 text-gray-700">
            <div class="flex items-start gap-3">
              <CalendarHeartIcon size={24} weight="fill" className="text-gold flex-shrink-0 mt-1" />
              <div>
                <p class="font-semibold">Sabtu, 13 Desember 2025</p>
                <p class="text-sm text-gray-500">Pukul 11.00 - Selesai</p>
              </div>
            </div>
            <div class="flex items-start gap-3">
              <BuildingIcon size={24} weight="fill" className="text-gold flex-shrink-0 mt-1" />
              <div>
                <p class="font-semibold">Gedung De' Premium Convention Center</p>
                <p class="text-sm text-gray-500">Jl. Soekarno Hatta No. 234, Siring Agung, Ilir Barat I, Palembang</p>
              </div>
            </div>
          </div>
          <a
            href={resepsiMapUrl}
            target="_blank"
            rel="noopener noreferrer"
            aria-label="Buka Google Maps - Lokasi Resepsi"
            class="mt-6 w-full bg-primary text-white py-3 rounded-lg font-semibold hover:bg-primary/90 transition-smooth flex items-center justify-center gap-2"
          >
            <MapPinLineIcon size={20} weight="fill" />
            Lihat Lokasi
          </a>
        </div>
      </div>
    </div>

    <!-- Map with Multiple Markers -->
    <div class="fade-in">
      <div class="bg-white rounded-2xl shadow-xl overflow-hidden"> 
        <EventMap markers={locations} client:only />
      </div>
    </div>

    <!-- Add to Calendar -->
    <div class="text-center mt-8 fade-in">
      <a
        href={googleCalendarUrl}
        target="_blank"
        rel="noopener noreferrer"
        aria-label="Tambahkan ke Google Kalender"
        class="bg-gold text-dark px-8 py-4 rounded-lg font-semibold text-lg hover:bg-gold/90 transition-smooth hover:scale-105 inline-flex items-center gap-3 shadow-lg"
      >
        <CalendarPlusIcon size={24} weight="fill" />
        Tambahkan ke Kalender
      </a>
    </div>
  </div>
</section>

<script>
  // Countdown Timer
  // Use explicit timezone (+07:00 for WIB) to ensure consistent countdown
  const countdownDate = new Date('2025-12-13T09:00:00+07:00').getTime();

  const updateCountdown = () => {
    const now = new Date().getTime();
    const distance = countdownDate - now;

    const days = Math.floor(distance / (1000 * 60 * 60 * 24));
    const hours = Math.floor((distance % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
    const minutes = Math.floor((distance % (1000 * 60 * 60)) / (1000 * 60));
    const seconds = Math.floor((distance % (1000 * 60)) / 1000);

    const daysEl = document.getElementById('event-days');
    const hoursEl = document.getElementById('event-hours');
    const minutesEl = document.getElementById('event-minutes');
    const secondsEl = document.getElementById('event-seconds');

    if (daysEl) daysEl.textContent = String(days).padStart(2, '0');
    if (hoursEl) hoursEl.textContent = String(hours).padStart(2, '0');
    if (minutesEl) minutesEl.textContent = String(minutes).padStart(2, '0');
    if (secondsEl) secondsEl.textContent = String(seconds).padStart(2, '0');

    if (distance < 0) {
      clearInterval(countdownInterval);
      if (daysEl) daysEl.textContent = '00';
      if (hoursEl) hoursEl.textContent = '00';
      if (minutesEl) minutesEl.textContent = '00';
      if (secondsEl) secondsEl.textContent = '00';
    }
  };

  const countdownInterval = setInterval(updateCountdown, 1000);
  updateCountdown();
</script>
